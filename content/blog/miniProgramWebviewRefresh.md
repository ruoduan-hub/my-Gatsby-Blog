---
title: å¾®ä¿¡å°ç¨‹åºWebViewåœ¨IOSä¸­å›é€€åˆ·æ–°é—®é¢˜
date: 2024-05-21
tags: è®°
comments: true
categories: è®°
---



### ç¼˜èµ·

åœ¨å¾®ä¿¡å°ç¨‹åºIOS æŸäº›ç‰ˆæœ¬ä¸­(æˆ‘é‡åˆ°çš„æ˜¯ 17^ )çš„ WebViewä¸­ï¼Œå›é€€å¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼›

æ— è®ºæ˜¯ä½¿ç”¨ `pageshow` ç›‘å¬è¿˜æ˜¯ï¼Œeffect éƒ½æ²¡ç”¨ï¼›

æ£é¼“äº†å„ç§æ–¹å¼ å‘ç°åµŒå¥— åœ¨ `iframe` ä¸­å¯ä»¥ï¼Œä½†æ˜¯è¿™æ ·çš„æ–¹å¼è¿‡äºå¤æ‚å’Œç›¸å½“äº åµŒå¥—äº†ä¸‰å±‚ï¼š

å¾®ä¿¡ WebView => iframe => Project A => ProjectBï¼Œäº¤äº’èµ·æ¥è¿‡äºéº»çƒ¦ã€‚



### Solve

> ç»è¿‡å¤šæ¬¡å°è¯•ï¼Œå‘ç°å°±æ˜¯å¾®ä¿¡å°ç¨‹åºåœ¨ IOSç‰¹å®šç³»ç»Ÿä¸­ï¼Œback ä¼šç¼“å­˜å½“å‰é¡µé¢ï¼Œå›é€€æ ¹æœ¬ä¸ä¼šè§¦å‘æ¸²æŸ“ï¼›ç›´æ¥é…ç½®åœ¨è¯¥é¡¹ç›®çš„ Nginx ä¸­é…ç½®ç¼“å­˜ `Cache-Control`  æŒ‡å®šæµè§ˆå™¨ no-cacheğŸ‘‡

```yaml
# Nginx Config
...

location /ProjectA {
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires 0;
}

...
```

- `Cache-Control "no-cache, no-store, must-revalidate";` å‘Šè¯‰æµè§ˆå™¨ä¸è¦ç¼“å­˜é¡µé¢çš„å‰¯æœ¬ï¼Œæ¯æ¬¡éƒ½éœ€è¦å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚å†…å®¹

- `add_header Pragma "no-cache";`ï¼š`Pragma` æ˜¯ä¸€ä¸ª HTTP/1.0 çš„é—ç•™æŒ‡ä»¤ï¼Œæ—§ç‰ˆæœ¬æµè§ˆå™¨ç‰¹å®šæŒ‡ä»¤ï¼Œè¿™é‡Œçš„å«ä¹‰æ˜¯ä¸è¦ç¼“å­˜é¡µé¢ã€‚

- `add_header Expires 0;`å€¼ä¸º `0`å°†è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºè¿‡å»çš„æ—¶é—´ï¼Œä»¥ç¡®ä¿æµè§ˆå™¨ç«‹å³å°†å†…å®¹æ ‡è®°ä¸ºè¿‡æœŸï¼Œä»è€Œä¸ä¼šç¼“å­˜é¡µé¢ã€‚
